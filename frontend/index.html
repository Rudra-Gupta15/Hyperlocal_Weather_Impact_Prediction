<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
  <meta name="description"
    content="Weather ML Dashboard - Live weather data with AI-powered predictions. Created by Rudra Kumar Gupta" />
  <meta name="theme-color" content="#0d0b1e" />
  <title>Weather ML Dashboard - Rudra Kumar Gupta</title>
  <link rel="icon" href="data:,">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="app">
    <!-- Mobile Header (hidden on desktop) -->
    <header class="mobile-header">
      <button class="menu-toggle" id="menuToggle" aria-label="Toggle menu">
        <i class="fas fa-bars"></i>
      </button>
      <h1 class="mobile-title">Weather ML</h1>
    </header>

    <!-- Sidebar Overlay (for mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Slim Sidebar -->
    <aside class="sidebar" id="sidebar">
      <a href="https://github.com/Rudra-Gupta15" target="_blank" rel="noopener noreferrer" class="logo"
        title="Visit Github">
        <img src="logo_v2.png" alt="RG" class="logo-img">
      </a>

      <nav class="nav">
        <button class="nav-btn active" data-view="weather" title="Weather">
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
          </svg>
        </button>
        <button class="nav-btn" data-view="cities" title="Cities">
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M15.5 1h-8C6.12 1 5 2.12 5 3.5v17C5 21.88 6.12 23 7.5 23h8c1.38 0 2.5-1.12 2.5-2.5v-17C18 2.12 16.88 1 15.5 1zm-4 21c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm4.5-4H7V4h8.5v14z" />
          </svg>
        </button>
        <button class="nav-btn" data-view="map" title="Map">
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M20.5 3l-6 2.25L8.5 3 3.5 4.88v15.24l6-2.25 6 2.25 5-1.88V3zM15 19l-6-2.25v-9l6 2.25V19zM5 18.24V5.48l3.5-1.31v12.79L5 18.24zM19 18.52l-3.5-1.31v-12.8L19 5.76v12.76z" />
          </svg>
        </button>
        <button class="nav-btn" data-view="analytics" title="Analytics">
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z" />
          </svg>
        </button>
        <button class="nav-btn" data-view="settings" title="Settings">
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" />
          </svg>
        </button>
      </nav>

      <div class="sidebar-wisdom">
        <div class="wisdom-icon">ğŸ’¡</div>
        <p id="weatherTip">Stay hydrated! Heat levels are rising today.</p>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="content">
      <!-- Search Section -->
      <header class="dashboard-header">
        <div class="search-bar">
          <i class="fas fa-search"></i>
          <input type="text" id="citySearch" class="search-input" placeholder="Search for a city or airport..."
            autocomplete="off">
          <div id="cityDropdown" class="city-dropdown hidden"></div>
        </div>
      </header>

      <!-- Layout Grid -->
      <div class="dashboard-grid">

        <!-- Column 1: Hero & Forecast -->
        <div class="grid-col main-col">
          <!-- Hero Card -->
          <section class="weather-hero">
            <div class="hero-header">
              <span class="label">WEATHER</span>
              <h1 id="cityName">Nagpur</h1>
              <p id="lastUpdated" class="timestamp"></p>
            </div>
            <div class="hero-body">
              <div class="temp-display">
                <h2 id="mainTemp">--Â°</h2>
                <p class="hero-condition" id="heroCondition">Loading...</p>
                <p class="hero-hilo" id="heroHiLo">H:--Â° L:--Â°</p>
              </div>
              <div class="weather-visual-container">
                <div id="celestialBody" class="celestial-body sun"></div>
                <div class="cloud-layer">
                  <div class="cloud cloud-1"></div>
                  <div class="cloud cloud-2"></div>
                </div>
              </div>
            </div>
          </section>

          <!-- Hourly / Weekly Forecast Tabs -->
          <div class="tile-card forecast-tile">
            <div class="forecast-tabs">
              <button class="forecast-tab active" id="tabHourly" onclick="switchForecastTab('hourly')">Hourly
                Forecast</button>
              <button class="forecast-tab" id="tabWeekly" onclick="switchForecastTab('weekly')">Weekly Forecast</button>
            </div>
            <div id="hourlyForecast" class="hourly-forecast"></div>
            <div id="weeklyForecastInline" class="weekly-list" style="display:none;"></div>
          </div>

          <!-- Air Quality Widget -->
          <div class="tile-card">
            <h3>ğŸŒ¬ï¸ Air Quality</h3>
            <div class="aqi-widget" style="border:none;padding:0;background:none;">
              <span class="aqi-value" id="aqiValue">3 â€” Low Health Risk</span>
              <div class="aqi-bar-track">
                <div class="aqi-bar-fill" id="aqiBarFill" style="width:25%"></div>
              </div>
              <p class="aqi-sub" id="aqiSub">Air quality is satisfactory</p>
              <a class="aqi-link" onclick="openModal('analyticsModal')">See more â†’</a>
            </div>
          </div>

          <!-- Heat Stress Index (ML Prediction) -->
          <div class="tile-card hsi-card">
            <h3>ğŸ¤– ML: Heat Stress Index</h3>
            <div class="hsi-body">
              <div class="hsi-gauge-wrap">
                <svg class="hsi-gauge-svg" viewBox="0 0 120 70">
                  <!-- Track arc -->
                  <path d="M10 65 A55 55 0 0 1 110 65" stroke="rgba(255,255,255,0.08)" stroke-width="10" fill="none"
                    stroke-linecap="round" />
                  <!-- Fill arc (progress) -->
                  <path id="hsiArcFill" d="M10 65 A55 55 0 0 1 110 65" stroke="url(#hsiGrad)" stroke-width="10"
                    fill="none" stroke-linecap="round" stroke-dasharray="173" stroke-dashoffset="86" />
                  <defs>
                    <linearGradient id="hsiGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                      <stop offset="0%" stop-color="#10b981" />
                      <stop offset="50%" stop-color="#f59e0b" />
                      <stop offset="100%" stop-color="#ef4444" />
                    </linearGradient>
                  </defs>
                  <text x="60" y="62" text-anchor="middle" fill="white" font-size="18" font-weight="700"
                    id="hsiGaugeVal">--</text>
                </svg>
              </div>
              <div class="hsi-info">
                <p class="hsi-label" id="hsiLabel">Calculating...</p>
                <p class="hsi-sublabel">Predicted by Linear Regression (RÂ²= 0.998)</p>
                <div class="hsi-legend">
                  <span class="hsi-dot" style="background:#10b981"></span><span>Low</span>
                  <span class="hsi-dot" style="background:#f59e0b"></span><span>Mid</span>
                  <span class="hsi-dot" style="background:#ef4444"></span><span>High</span>
                </div>
              </div>
            </div>
          </div>

          <!-- What To Wear Today -->
          <div class="tile-card wtw-card">
            <h3>ğŸ‘• What To Wear Today</h3>
            <div class="wtw-grid" id="wtwGrid">
              <div class="wtw-item"><span class="wtw-icon">ğŸ‘•</span><span class="wtw-text" id="wtwTop">Light
                  shirt</span></div>
              <div class="wtw-item"><span class="wtw-icon">ğŸ‘–</span><span class="wtw-text" id="wtwBottom">Comfortable
                  trousers</span></div>
              <div class="wtw-item"><span class="wtw-icon">ğŸ‘Ÿ</span><span class="wtw-text" id="wtwShoes">Casual
                  shoes</span></div>
              <div class="wtw-item"><span class="wtw-icon">ğŸŒ‚</span><span class="wtw-text" id="wtwExtra">No umbrella
                  needed</span></div>
            </div>
          </div>
        </div>

        <!-- Column 2: Details & Metrics -->
        <div class="grid-col details-col">
          <!-- UV Index & Sunrise Pair -->
          <div class="tile-card">
            <div class="metric-pair-grid">
              <div class="metric-pair-item">
                <div class="mp-icon"><i class="fas fa-sun"></i> UV INDEX</div>
                <div class="mp-val" id="uvIndex">4</div>
                <div class="mp-label" id="uvLabel">Moderate</div>
              </div>
              <div class="metric-pair-item">
                <div class="mp-icon"><i class="fas fa-sunrise"></i> SUNRISE</div>
                <div class="mp-val" id="sunrise">--:--</div>
                <div class="mp-label" id="sunsetLabel">Sunset: <span id="sunset">--:--</span></div>
              </div>
            </div>
            <!-- Sunrise arc -->
            <div class="sunrise-arc" style="margin-top:14px;">
              <svg viewBox="0 0 160 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 45 Q80 -10 150 45" stroke="rgba(167,139,250,0.3)" stroke-width="1.5" fill="none"
                  stroke-dasharray="4 3" />
                <circle id="sunArcDot" cx="80" cy="10" r="5" fill="#f59e0b" filter="url(#sunGlow)" />
                <defs>
                  <filter id="sunGlow" x="-100%" y="-100%" width="300%" height="300%">
                    <feGaussianBlur stdDeviation="3" result="blur" />
                    <feMerge>
                      <feMergeNode in="blur" />
                      <feMergeNode in="SourceGraphic" />
                    </feMerge>
                  </filter>
                </defs>
              </svg>
            </div>
          </div>

          <!-- Air Conditions Grid -->
          <div class="tile-card conditions-tile">
            <h3>Air Conditions</h3>
            <div class="conditions-grid-new">
              <div class="condition-item">
                <div class="condition-icon"><i class="fas fa-temperature-high"></i></div>
                <div class="condition-info">
                  <p class="label">Real Feel</p>
                  <p id="feelsLike" class="value">--Â°</p>
                </div>
              </div>
              <div class="condition-item">
                <div class="condition-icon"><i class="fas fa-wind"></i></div>
                <div class="condition-info">
                  <p class="label">Wind</p>
                  <p id="windSpeed" class="value">-- km/h</p>
                </div>
              </div>
              <div class="condition-item">
                <div class="condition-icon"><i class="fas fa-tint"></i></div>
                <div class="condition-info">
                  <p class="label">Humidity</p>
                  <p id="humidity" class="value">--%</p>
                </div>
              </div>
              <div class="condition-item">
                <div class="condition-icon"><i class="fas fa-cloud-rain"></i></div>
                <div class="condition-info">
                  <p class="label">Rain Chance</p>
                  <p id="rainChance" class="value">0%</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Wind & Rainfall Pair -->
          <div class="tile-card">
            <div class="metric-pair-grid">
              <div class="metric-pair-item">
                <div class="mp-icon"><i class="fas fa-wind"></i> WIND</div>
                <div class="mp-val" id="windMain">-- km/h</div>
                <div class="mp-label">North â†‘</div>
              </div>
              <div class="metric-pair-item">
                <div class="mp-icon"><i class="fas fa-cloud-showers-heavy"></i> RAINFALL</div>
                <div class="mp-val" id="rainfallMain">--</div>
                <div class="mp-label">in last hour</div>
              </div>
            </div>
          </div>

          <!-- Environment Metrics -->
          <div class="tile-card environment-tile">
            <h3>Environment</h3>
            <div class="env-grid-new">
              <div class="env-item">
                <span class="env-icon"><i class="fas fa-eye"></i></span>
                <div class="env-data">
                  <p class="env-label">Visibility</p>
                  <p id="visibility" class="env-value">-- km</p>
                </div>
              </div>
              <div class="env-item">
                <span class="env-icon"><i class="fas fa-cloud"></i></span>
                <div class="env-data">
                  <p class="env-label">Cloud Cover</p>
                  <p id="clouds" class="env-value">--%</p>
                </div>
              </div>
              <div class="env-item">
                <span class="env-icon"><i class="fas fa-compress-alt"></i></span>
                <div class="env-data">
                  <p class="env-label">Pressure</p>
                  <p id="pressure" class="env-value">-- hPa</p>
                </div>
              </div>
              <div class="env-item">
                <span class="env-icon"><i class="fas fa-moon"></i></span>
                <div class="env-data">
                  <p class="env-label">Sunset</p>
                  <p id="sunsetEnv" class="env-value">--:--</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Column 3: City Cards & Map -->
        <div class="grid-col sidebar-col">
          <!-- City Preview Cards (inspired by reference right panel) -->
          <div class="tile-card">
            <h3>ğŸŒ Indian Cities</h3>
            <div class="city-cards-preview" id="cityCardsPreview">
              <!-- Populated by JS -->
              <div class="city-preview-item" data-city="Bengaluru">
                <div class="city-preview-left">
                  <div class="city-preview-temp">19Â°</div>
                  <div class="city-preview-hilo">H:21Â° L:15Â°</div>
                  <div class="city-preview-name">Bengaluru, India</div>
                  <div class="city-preview-cond">Mild Rain</div>
                </div>
                <div class="city-preview-icon">ğŸŒ§ï¸</div>
              </div>
              <div class="city-preview-item" data-city="Chennai">
                <div class="city-preview-left">
                  <div class="city-preview-temp">22Â°</div>
                  <div class="city-preview-hilo">H:25Â° L:18Â°</div>
                  <div class="city-preview-name">Chennai, India</div>
                  <div class="city-preview-cond">Fast Wind</div>
                </div>
                <div class="city-preview-icon">ğŸŒ¬ï¸</div>
              </div>
              <div class="city-preview-item" data-city="Delhi">
                <div class="city-preview-left">
                  <div class="city-preview-temp">29Â°</div>
                  <div class="city-preview-hilo">H:32Â° L:24Â°</div>
                  <div class="city-preview-name">Delhi, India</div>
                  <div class="city-preview-cond">Cloudy</div>
                </div>
                <div class="city-preview-icon">â˜ï¸</div>
              </div>
            </div>
          </div>

          <!-- 7-day forecast (sidebar column) -->
          <div class="tile-card weekly-tile">
            <h3>7-Day Forecast</h3>
            <div id="weeklyForecast" class="weekly-list"></div>
          </div>

          <!-- Weather Radar -->
          <div class="tile-card map-tile">
            <h3>Weather Radar</h3>
            <div class="mini-map-container" onclick="openModal('mapModal')">
              <p>ğŸ“ View Interactive Map</p>
              <div class="map-preview-hint">Click to expand radar</div>
            </div>
          </div>
        </div>

      </div>

      <!-- Bottom Section: ML Models -->
      <div class="tile-card models-tile">
        <h3>ğŸ“Š ML Models Performance</h3>
        <div id="modelCards" class="model-cards"></div>
      </div>

      <footer class="footer-credit">
        <p>Created by <strong>Rudra Kumar Gupta</strong> |
          <a href="https://rudra-portfolio-liart.vercel.app/" target="_blank" rel="noopener noreferrer">Portfolio</a>
        </p>
      </footer>
    </main>

    <!-- Modals -->
    <div id="citiesModal" class="modal hidden">
      <div class="modal-content">
        <button class="modal-close">&times;</button>
        <h2>Select City</h2>
        <div id="citiesList" class="cities-list"></div>
      </div>
    </div>
    <div id="mapModal" class="modal hidden">
      <div class="modal-content modal-large">
        <button class="modal-close">&times;</button>
        <h2>Weather Map</h2>
        <div class="map-container">
          <div id="weatherMap"></div>
        </div>
      </div>
    </div>
    <div id="analyticsModal" class="modal hidden">
      <div class="modal-content modal-large">
        <button class="modal-close">&times;</button>
        <h2>ğŸ“Š Analytics Dashboard</h2>

        <div class="analytics-grid">
          <div class="analytics-card">
            <h4>ğŸ¯ Model Performance</h4>
            <div class="model-performance-container">
              <img src="model_comparison.png" alt="Model Performance Comparison" class="analytics-img">
            </div>
          </div>

          <div class="analytics-card">
            <h4>ğŸ“ˆ Accuracy Metrics</h4>
            <div class="metrics-list">
              <div class="metric-item">
                <span class="metric-label">Average MAE</span>
                <span class="metric-value" id="avgMAE">0.764Â°C</span>
              </div>
              <div class="metric-item">
                <span class="metric-label">Average RMSE</span>
                <span class="metric-value" id="avgRMSE">0.990Â°C</span>
              </div>
              <div class="metric-item">
                <span class="metric-label">Average RÂ²</span>
                <span class="metric-value" id="avgR2">0.9627</span>
              </div>
              <div class="metric-item">
                <span class="metric-label">Predictions Made</span>
                <span class="metric-value" id="predictionCount">1,247</span>
              </div>
            </div>
          </div>

          <div class="analytics-card full-width">
            <h4>ğŸ”¬ Model Comparison</h4>
            <div class="comparison-table">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Model</th>
                    <th>MAE (Â°C)</th>
                    <th>RMSE (Â°C)</th>
                    <th>RÂ² Score</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody id="modelComparisonTable">
                  <tr>
                    <td>Linear Regression</td>
                    <td>0.280</td>
                    <td>0.340</td>
                    <td>0.9981</td>
                    <td><span class="badge badge-success">Excellent</span></td>
                  </tr>
                  <tr>
                    <td>Random Forest</td>
                    <td>1.233</td>
                    <td>1.639</td>
                    <td>0.9556</td>
                    <td><span class="badge badge-warning">Good</span></td>
                  </tr>
                  <tr>
                    <td>Gradient Boosting</td>
                    <td>0.780</td>
                    <td>0.990</td>
                    <td>0.9345</td>
                    <td><span class="badge badge-info">Very Good</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="analytics-card full-width">
            <h4>ğŸ“Š Training History</h4>
            <div class="training-info">
              <div class="info-item">
                <span class="info-icon">ğŸ—“ï¸</span>
                <div>
                  <p class="info-label">Last Training</p>
                  <p class="info-value">January 28, 2026</p>
                </div>
              </div>
              <div class="info-item">
                <span class="info-icon">ğŸ“¦</span>
                <div>
                  <p class="info-label">Dataset Size</p>
                  <p class="info-value">10,000+ records</p>
                </div>
              </div>
              <div class="info-item">
                <span class="info-icon">â±ï¸</span>
                <div>
                  <p class="info-label">Training Time</p>
                  <p class="info-value">45 minutes</p>
                </div>
              </div>
              <div class="info-item">
                <span class="info-icon">âœ…</span>
                <div>
                  <p class="info-label">Model Status</p>
                  <p class="info-value">Production Ready</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="settingsModal" class="modal hidden">
      <div class="modal-content">
        <button class="modal-close">&times;</button>
        <h2>Settings</h2>

        <div class="settings-section">
          <h3>ğŸ¨ Appearance</h3>
          <div class="setting-item">
            <div class="setting-info">
              <label for="darkMode">Dark Mode</label>
              <p class="setting-description">Toggle dark/light theme</p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="darkMode" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <label for="animations">Animations</label>
              <p class="setting-description">Enable smooth animations</p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="animations" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="settings-section">
          <h3>ğŸŒ¡ï¸ Units</h3>
          <div class="setting-item">
            <div class="setting-info">
              <label for="tempUnit">Temperature Unit</label>
              <p class="setting-description">Choose Celsius or Fahrenheit</p>
            </div>
            <select id="tempUnit" class="setting-select">
              <option value="metric">Celsius (Â°C)</option>
              <option value="imperial">Fahrenheit (Â°F)</option>
            </select>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <label for="windUnit">Wind Speed Unit</label>
              <p class="setting-description">Choose your preferred unit</p>
            </div>
            <select id="windUnit" class="setting-select">
              <option value="kmh">Kilometers/hour</option>
              <option value="mph">Miles/hour</option>
              <option value="ms">Meters/second</option>
            </select>
          </div>
        </div>

        <div class="settings-section">
          <h3>ğŸ”” Notifications</h3>
          <div class="setting-item">
            <div class="setting-info">
              <label for="weatherAlerts">Weather Alerts</label>
              <p class="setting-description">Get notified about severe weather</p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="weatherAlerts">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <label for="autoRefresh">Auto Refresh</label>
              <p class="setting-description">Update weather automatically</p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="autoRefresh" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="settings-actions">
          <button class="btn-secondary" onclick="resetSettings()">Reset to Default</button>
          <button class="btn-primary" onclick="saveSettings()">Save Settings</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script src="script.js"></script>
  <script>
    // â”€â”€ Forecast Tab Switch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function switchForecastTab(tab) {
      const hourlyEl = document.getElementById('hourlyForecast');
      const weeklyEl = document.getElementById('weeklyForecastInline');
      const tabH = document.getElementById('tabHourly');
      const tabW = document.getElementById('tabWeekly');
      if (tab === 'hourly') {
        hourlyEl.style.display = '';
        weeklyEl.style.display = 'none';
        tabH.classList.add('active');
        tabW.classList.remove('active');
      } else {
        hourlyEl.style.display = 'none';
        weeklyEl.style.display = '';
        tabH.classList.remove('active');
        tabW.classList.add('active');
        // Mirror weekly list into inline element
        const src = document.getElementById('weeklyForecast');
        if (src) weeklyEl.innerHTML = src.innerHTML;
      }
    }

    // â”€â”€ City Preview Card Clicks â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.querySelectorAll('.city-preview-item').forEach(card => {
      card.addEventListener('click', async () => {
        const city = card.dataset.city;
        if (city && typeof loadWeatherDataWithTransition === 'function') {
          currentCity = city;
          await loadWeatherDataWithTransition(city);
        }
      });
    });

    // â”€â”€ Mirror sunset to env panel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const origUpdateUI = window.updateWeatherUI;
    window.updateWeatherUI = function (data, forecastData) {
      if (origUpdateUI) origUpdateUI(data, forecastData);
      // Mirror sunset
      const sunsetEnvEl = document.getElementById('sunsetEnv');
      const sunsetEl = document.getElementById('sunset');
      if (sunsetEnvEl && sunsetEl) sunsetEnvEl.textContent = sunsetEl.textContent;
      // Mirror wind to wind main card
      const windMainEl = document.getElementById('windMain');
      const windSpeedEl = document.getElementById('windSpeed');
      if (windMainEl && windSpeedEl) windMainEl.textContent = windSpeedEl.textContent;
      // Hero condition + hi/lo
      if (data && data.weather && data.weather[0]) {
        const condEl = document.getElementById('heroCondition');
        if (condEl) condEl.textContent = data.weather[0].description.replace(/\b\w/g, c => c.toUpperCase());
      }
      if (data && data.main) {
        const hiloEl = document.getElementById('heroHiLo');
        const sym = (typeof getTempUnitSymbol === 'function') ? getTempUnitSymbol() : 'Â°';
        const getT = (typeof getTemperature === 'function') ? getTemperature : v => Math.round(v);
        if (hiloEl) hiloEl.textContent = `H:${getT(data.main.temp_max)}${sym}  L:${getT(data.main.temp_min)}${sym}`;
      }
      // Basic AQI mock (real AQI needs separate API call)
      const aqiEl = document.getElementById('aqiValue');
      const aqiBar = document.getElementById('aqiBarFill');
      if (data && data.main && aqiEl) {
        const aqi = Math.min(6, Math.max(1, Math.round(data.main.humidity / 18)));
        const labels = ['1 â€” Good', '2 â€” Fair', '3 â€” Moderate', '4 â€” Poor', '5 â€” Very Poor', '6 â€” Hazardous'];
        aqiEl.textContent = labels[aqi - 1] || '3 â€” Moderate';
        if (aqiBar) aqiBar.style.width = (aqi / 6 * 100) + '%';
      }
      // UV index mock
      const uvEl = document.getElementById('uvIndex');
      const uvLabelEl = document.getElementById('uvLabel');
      if (data && data.main && uvEl) {
        const uv = Math.round((data.main.temp - 10) / 5);
        const uvSafe = Math.min(11, Math.max(0, uv));
        uvEl.textContent = uvSafe;
        const uvLabels = ['Low', 'Low', 'Low', 'Moderate', 'Moderate', 'Moderate', 'High', 'High', 'Very High', 'Very High', 'Extreme', 'Extreme'];
        if (uvLabelEl) uvLabelEl.textContent = uvLabels[uvSafe] || 'Moderate';
      }

      // â”€â”€ Heat Stress Index gauge â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      if (data && data.main) {
        const t = data.main.temp;
        const rh = data.main.humidity / 100;
        const es = 6.112 * Math.exp((17.62 * t) / (t + 243.12));
        const e = rh * es;
        const hsi = Math.round(t + 0.5555 * (e - 10));

        const gaugeVal = document.getElementById('hsiGaugeVal');
        const hsiLbl = document.getElementById('hsiLabel');
        const arcFill = document.getElementById('hsiArcFill');

        if (gaugeVal) gaugeVal.textContent = hsi + 'Â°';

        // Arc: total dash length â‰ˆ 173 (half-circle circumference for r=55)
        // Map hsi range [10, 50] â†’ dashoffset [173 (empty) â†’ 0 (full)]
        const pct = Math.min(1, Math.max(0, (hsi - 10) / 40));
        if (arcFill) arcFill.style.strokeDashoffset = (173 * (1 - pct)).toFixed(1);

        if (hsiLbl) {
          if (hsi < 20) hsiLbl.textContent = 'No Discomfort';
          else if (hsi < 28) hsiLbl.textContent = 'Slight Discomfort';
          else if (hsi < 35) hsiLbl.textContent = 'Moderate Discomfort';
          else if (hsi < 40) hsiLbl.textContent = 'High Discomfort';
          else hsiLbl.textContent = 'Danger Zone!';
        }
      }

      // â”€â”€ What To Wear â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      if (data && data.main) {
        const temp = data.main.temp;
        const wind = data.wind ? data.wind.speed * 3.6 : 0; // m/s â†’ km/h
        const rainPop = (forecastData && forecastData.list && forecastData.list[0])
          ? forecastData.list[0].pop * 100 : 0;

        const wtwTop = document.getElementById('wtwTop');
        const wtwBottom = document.getElementById('wtwBottom');
        const wtwShoes = document.getElementById('wtwShoes');
        const wtwExtra = document.getElementById('wtwExtra');

        if (wtwTop) {
          if (temp >= 35) wtwTop.textContent = 'Sleeveless / Tank top';
          else if (temp >= 28) wtwTop.textContent = 'Light cotton shirt';
          else if (temp >= 20) wtwTop.textContent = 'Casual t-shirt';
          else if (temp >= 12) wtwTop.textContent = 'Light sweater / hoodie';
          else wtwTop.textContent = 'Warm jacket / coat';
        }
        if (wtwBottom) {
          if (temp >= 25) wtwBottom.textContent = 'Shorts / cotton trousers';
          else if (temp >= 15) wtwBottom.textContent = 'Jeans / casual pants';
          else wtwBottom.textContent = 'Warm trousers / thermals';
        }
        if (wtwShoes) {
          if (rainPop > 50) wtwShoes.textContent = 'Rain boots / waterproof';
          else if (temp >= 28) wtwShoes.textContent = 'Sandals / flip-flops';
          else wtwShoes.textContent = 'Sneakers / casual shoes';
        }
        if (wtwExtra) {
          if (rainPop > 60) wtwExtra.textContent = 'â˜” Carry umbrella';
          else if (rainPop > 30) wtwExtra.textContent = 'ğŸŒ¦ï¸ Light rain jacket';
          else if (wind > 30) wtwExtra.textContent = 'ğŸŒ¬ï¸ Wear a windbreaker';
          else if (temp >= 32) wtwExtra.textContent = 'ğŸ•¶ï¸ Sunglasses + sunscreen';
          else wtwExtra.textContent = 'âœ… No extras needed';
        }
      }
    };
  </script>
</body>

</html>